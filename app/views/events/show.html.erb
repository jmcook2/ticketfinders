<% title @event.name %>
<% gon include_gon %>

<% if @competition && @player %>

  <div class="row gotham-regular">
    <ul class="breadcrumbs">
      <li><%= link_to 'Home', root_url %></li>
      <li><%= link_to 'Categories', categories_path %></li>
      <li><%= link_to @category.description, category_path(@category) %></li>
      <li><%= link_to @competition.name, competition_path(@competition) %></li>
      <li><%= link_to @player.name, player_path(@player, :comp => @competition) %></li>
      <li class="current"><%= @event.name %></li>
    </ul>
  </div>

<% elsif @competition %>

  <div class="row gotham-regular">
    <ul class="breadcrumbs">
      <li><%= link_to 'Home', root_url %></li>
      <li><%= link_to 'Categories', categories_path %></li>
      <li><%= link_to @category.description, category_path(@category) %></li>
      <li><%= link_to @competition.name, competition_path(@competition) %></li>
      <li class="current"><%= @event.name %></li>
    </ul>
  </div>

<% else %>

<div class="row gotham-regular">
  <ul class="breadcrumbs">
    <li><%= link_to 'Home', root_url %></li>
    <li><%= link_to 'Categories', categories_path %></li>
    <li><%= link_to @category_description, category_path(@category) %></li>
    <li class="current"><%= @event.name %></li>
  </ul>
</div>

<% end %>

<section class="grey-bg">
  <div class="row">
    <div class="small-6 medium-7 columns">
      <h4 class="gotham-regular" style="color: #2C9DDF;"><%= @event.name %></h4>
      <ul class="event-show-list gotham-light">
        <!-- This line checks if event has a competition, and outputs it if it does -->
        <li><%= @competition.name if @competition %></li>
        <li><%= @event.venue.name %></li>
        <li><%= nice_time(@event.start_time) %></li>
      </ul>
      <ul class="social-list-container">
        <li class="social-list-icon">
          <a href="https://twitter.com/share" class="twitter-share-button" data-hashtags="ticketfinders">Tweet</a>
          <script>
            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
          </script>
        </li>
        <li class="social-list-icon">
          <div class="fb-like" data-layout="button_count" data-action="like" data-show-faces="true" data-share="false"></div>
        </li>
      </ul>
    </div>
      <div class="small-6 medium-5 columns">
        <%= image_tag(@event.venue.avatar.url) %>
      </div>
  </div>
</section>

<div class="row">&nbsp;</div>

  <% if @event.tickets.sum(:quantity) > 0 %>

  <div class="row">
    <div class="small-12 medium-7 columns">

    <div class="row table">
      <div class="small-12 white-bg columns">
        <% @event.tickets.each do |ticket| %>
          <div class="row ticket-table-row">
            <div class="small-5 columns table-one">
              <h5 class="gotham-regular" style="font-size: 1rem;"><%= ticket.category %></h5>
            </div>
            <div class="small-5 columns table-two">
              <h5 class="gotham-regular" style="font-size: 1rem; color: #2D669A">&pound;<%= ticket.price.round %></h5>
            </div>
            <%= link_to ticket_path(ticket) do %>
              <div class="small-2 columns text-center ticket-buy">
                <span class="gotham-light" style="color: #FFFFFF;">Buy</span>
              </div>
            <% end %>
          </div>
        <% end %>
      </div>

      </div>
      </div>

<% # recommended(@event).each do |event| %>

    </div>

    <div class="row">&nbsp;</div>

  <% else %>

    <div class="row">
      <div class="small-12 medium-6 white-bg columns text-center">
        <p class="gotham-regular">There are no tickets for this event</p>
      </div>
      <div class="small-12 medium-5 medium-offset-1 columns recommended">
        <div class="row text-center recommended-header">
          <h4 class="gotham-regular" style="color: #2C9DDF;">Recommended</h4>
        </div>
        <% recommended(@event).each do |event| %>
          <div class="row">
            <div class="small-6 columns">
              <%= event.name %>
            </div>
            <div class="small-6 text-left columns">
              <%= link_to event.name, event_path(event), data: { no_turbolink: true }, class: "event-link" %><br />
              <%= nice_time(event.start_time) %>
            </div>
          </div>
          <div class="tiny-pad"></div>
        <% end %>
      </div>
    </div>

  <% end %>

</section>

<div class="map-container">
  <div id="map"></div>
  <span class="overlay-background">
    <div class="map-text gotham-regular"><%= @event.venue.address %></div>
  </span>
</div>

<script async defer src="https://maps.googleapis.com/maps/api/js?callback=initMap"></script>

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5&appId=1559392074321796";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
