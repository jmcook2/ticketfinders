<% title @event.name %>
<% gon include_gon %>

<% if @competition && @player %>

  <div class="row">
    <ul class="breadcrumbs">
      <li><%= link_to 'Home', root_url %></li>
      <li><%= link_to 'Categories', categories_path %></li>
      <li><%= link_to @category.description, category_path(@category) %></li>
      <li><%= link_to @competition.name, competition_path(@competition) %></li>
      <li><%= link_to @player.name, player_path(@player, :comp => @competition) %></li>
      <li class="current"><%= @event.name %></li>
    </ul>
  </div>

<% elsif @competition %>

  <div class="row">
    <ul class="breadcrumbs">
      <li><%= link_to 'Home', root_url %></li>
      <li><%= link_to 'Categories', categories_path %></li>
      <li><%= link_to @category.description, category_path(@category) %></li>
      <li><%= link_to @competition.name, competition_path(@competition) %></li>
      <li class="current"><%= @event.name %></li>
    </ul>
  </div>

<% else %>

<div class="row">
  <ul class="breadcrumbs">
    <li><%= link_to 'Home', root_url %></li>
    <li><%= link_to 'Categories', categories_path %></li>
    <li><%= link_to @category_description, category_path(@category) %></li>
    <li class="current"><%= @event.name %></li>
  </ul>
</div>

<% end %>

<section class="grey-bg">
  <div class="row">
    <div class="small-6 medium-5 columns" style="padding-left: 0;">
      <%= image_tag @event.avatar.url %>
    </div>
    <div class="small-6 medium-7 columns">
      <h4 style="color: #2D669A;"><%= @event.name %></h4>
      <ul class="event-show-list">
        <li><%= @event.venue.name %></li>
        <li><%= nice_time(@event.start_time) %></li>
        <br />
        <li>
          <a href="https://twitter.com/share" class="twitter-share-button" data-hashtags="ticketfinders">Tweet</a>
          <script>
            !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
          </script>
        </li>
        <li>
          &nbsp;&nbsp;&nbsp;<div class="fb-like" data-layout="button_count" data-action="like" data-show-faces="true" data-share="false"></div>
        </li>
      </ul>
    </div>
  </div>
  <div class="row">&nbsp;</div>

  <% if @event.tickets.sum(:quantity) > 0 %>

    <div class="row">
      <div class="small-12 medium-7 white-bg columns">
        <table role="grid">
          <tr>
            <th width="300" scope="column"><h4 class="gotham-regular" style="color: #2D669A;">Category</h5></th>
            <th width="300" scope="column"><h4 class="gotham-regular" style="color: #2D669A;">Price</h4></th>
          </tr>
          <% @event.tickets.each do |ticket| %>
            <tr>
              <td scope="row"><%= ticket.category %></td>
              <td scope="row">&pound;<%= ticket.price.round %></td>
              <td scope="row"><%= link_to 'Tickets', root_url, class: 'button success tiny' %></td>
            </tr>
          <% end %>
        </table>
      </div>

      <div class="small-12 medium-5 columns recommended">
        <% recommended(@event).each do |event| %>
          <%= link_to event.name, event_path(event), data: { no_turbolink: true } %>
        <% end %>
      </div>

    </div>

  <% else %>

    <div class="row">
      <div class="small-12 medium-8 white-bg columns">
        <p class="gotham-bold">There are no tickets for this event</p>
      </div>
      <div class="small-12 medium-4 columns">
        Recommended Events
      </div>
    </div>

  <% end %>

</section>

<div class="map-container">
  <div id="map"></div>
  <span class="overlay-background">
    <div class="map-text gotham-regular"><%= @event.venue.address %></div>
  </span>
</div>

<script async defer src="https://maps.googleapis.com/maps/api/js?callback=initMap"></script>

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5&appId=1559392074321796";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
